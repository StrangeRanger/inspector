# Identifying Logs (Doc 1)

When users use `su`:

|                  | su                                                                                         | su root                                                                                    | su [username]                                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------ |
| **Successful**   | **Log input:** `su: (to root) <username> on pts/<n>`<br>*Identifying Symbol:* +            | **Log input:** `su: (to root) <username> on pts/<n>`<br>*Identifying Symbol:* +            | **Log input:** `su: (to <victim_username>) <username> on pts/<n>`<br>*Identifying Symbol:* –           |
| **Unsuccessful** | **Log input:** `su: FAILED SU (to root) <username> on pts/<n>`<br>*Identifying Symbol:* \* | **Log input:** `su: FAILED SU (to root) <username> on pts/<n>`<br>*Identifying Symbol:* \* | **Log input:** `su: FAILED SU (to <victim_username>) <username> on pts/<n>`<br>*Identifying Symbol:* / |

When users use `sudo su`:

|                                                        | sudo su                                                                                                                                                                                                                                      | sudo su root                                                                                                                                                                                                                                      | sudo su [username]                                                                                                                                                                                                                                                          |
| ------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Successful**                                         | **Log input (line 1):** `sudo: <username> : TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su`<br>**Log input (line 3):** `su: (to root) <username> on pts/<n>`<br>**_Note 1 (refer to Info block below table)_**<br>*Identifying Symbol:* + | **Log input (line 1):** `sudo: <username> : TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su root`<br>**Log input (line 3):** `su: (to root) <username> on pts/<n>`<br>**_Note 1 (refer to Info block below table)_**<br>*Identifying Symbol:* + | **Log input (line 1):** `sudo: <username> : TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su <victim_username>`<br>**Log input (line 3):** `su: (to <victim_username>) <username> on pts/<n>`<br>**_Note 1 (refer to Info block below table)_**<br>*Identifying Symbol:* – |
| **Unsuccessful (even if <username\> does not exist)**  | **Log input:** `sudo: <username> : <n> incorrect password attempt ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su`<br>*Identifying Symbol:* \*                                                                                           | **Log input:** `sudo: <username> : <n> incorrect password attempt ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su root`<br>*Identifying Symbol:* \*                                                                                           | **Log input:** `sudo: <username> : <n> incorrect password attempt ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/su <victim_username>`<br>*Identifying Symbol:* /                                                                                                         |
| **Successful attempt when <username\> does not exist** | N/A                                                                                                                                                                                                                                          | N/A                                                                                                                                                                                                                                               | **Log input:** ...............<br>*Identifying Symbol:* N/A (we want it to be /) (future fix)                                                                                                                                                                               |

!!! Info "Note 1"
    The script uses “Log input (line 3)”, because “line 3” is exactly the same for the above table (the su table). Since the script looks for “line 3” when the su command is used, if it looks for “line 1” when sudo is used, it would cause the script to identify the user twice as many times

Other `sudo` alternatives:

|                  | sudo -i                                                                                                                                               | sudo bash                                                                                                                                             |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Successful**   | **Log input:** `sudo: <username> : TTY=<n> ; PWD= <pwd> ; USER=root ; COMMAND=/bin/bash`<br>*Identifying Symbol:* +                                   | **Log input:** `sudo: <username> : TTY=<n> ; PWD= <pwd> ; USER=root ; COMMAND=/bin/bash`<br>*Identifying Symbol:* +                                   |
| **Unsuccessful** | **Log input:** `sudo: <username> : <n> incorrect password attempts ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/bash`<br>*Identifying Symbol:* \* | **Log input:** `sudo: <username> : <n> incorrect password attempts ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=/bin/bash`<br>*Identifying Symbol:* \* |

When users who don't have sudo power use `sudo`:

|                                                           | sudo [command]                                                                                                                                          |
| --------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sudo used when <username\> is not in the sudoers file** | **Log input:** `sudo: <username> : user NOT in sudoers ; TTY=<n> ; PWD=<pwd> ; USER=root ; COMMAND=<command execution path>`<br>*Identifying Symbol:* ~ |
